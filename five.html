<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" id="viewport">
    <title>积分转大运</title>
    <link rel="stylesheet" href="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/8yuexiaomiqudao/swiper.min.css">
    <style>
        *{margin:0;padding:0;}
        body{width:100%;height:100%;font-family:"PingFang SC Regular";background: #501fa7;padding-bottom:1.5rem;overflow-x: hidden}
        .box{position: relative;}
        .box img{display:block}
        #deng{width:80%; padding:4%;margin:0 auto;background-size:100% 100%;}
        .shanDeng{background:url("http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/deng1.png")no-repeat;}
        .shanDeng2{background:url("http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/deng2.png")no-repeat}
        .items{background: #faf1ff;text-align: center;padding:4% 0;width:32%;border-radius:.5rem;}
        .items img{width:70%;text-align: center;display: inline-block;vertical-align: middle}
        .flex{display: flex;justify-content: space-around;display: -webkit-flex;-webkit-justify-content:space-around}
        .lottery-mid,.lottery-foot{margin-top:.5rem;}
        .footer{text-align: center;color:#fff;margin-top:1.5rem;}
        .num{color:#f6d63b;font-weight:600}
        .lottery-btn{margin-top:1rem;}
        .lottery-btn div{display: inline-block}
        .left-btn{text-align: center;padding:0.5rem 2.5rem ;background: #ff4040;color:#fff;border-radius:999px;margin-right:1rem;}
        .right-btn{text-align: center;padding:0.5rem 2.5rem ;background: #ff4040;color:#fff;border-radius:999px;}
        .my-jf{position: absolute;width:20rem;left:50%;margin-left:-9rem;bottom:0.3rem;text-align: center;color: #fff;font-family: "PingFang SC Regular"}
        /*===滚动播放===*/
        .swiper-container {width:100%;height: 1rem!important;position: absolute;bottom:-0.7rem;left:0.5rem;}
        .swiper-slide { color:#fff;text-align:center;font-size: 0.875rem;width: 80%;  line-height:2rem;  margin: 0 auto;    display: -webkit-box;  display: -ms-flexbox;  display: -webkit-flex;  display: flex;  -webkit-box-pack: center;  -ms-flex-pack: center;  -webkit-justify-content: center;  justify-content: center;  -webkit-box-align: center;  -ms-flex-align: center;  -webkit-align-items: center;
            align-items: center;}
        .cj-active{background:#facf02;}
        .another-active{background:#facf02}
    </style>
</head>
<body>
<div class="box">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/jf_03.png" width="100%">
</div>
<div class="box">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/jf_05.png" width="100%">
    <div class="my-jf">&nbsp;&nbsp;我的积分：200000积分</div>
</div>
<div class="box">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/jf_06.png" width="100%">
</div>
<div class="box">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/jf_07.png" width="100%">
    <div class="swiper-container" style="margin:1rem 0;">
        <div class="swiper-wrapper">
            <div class="swiper-slide">刚刚用户134****23$5&nbsp;&nbsp;&nbsp;投资获得小米二级</div>
            <div class="swiper-slide">刚刚用户13488882222&nbsp;&nbsp;&nbsp;投资获得小米画板</div>
            <div class="swiper-slide">*用户8888&nbsp;&nbsp;&nbsp;投资获得小米插线板</div>
            <div class="swiper-slide">*用户8888&nbsp;&nbsp;&nbsp;投资获得小米插线板</div>
        </div>
    </div>
</div>
<div class="box">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/jf_08.png" width="100%">
</div>
<div class="shanDeng" id="deng">
    <div class="lottery"  id="lottery">
        <div class="lottery-top flex">
            <div class="items lottery-unit-0">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_01.png">
            </div>
            <div class="items lottery-unit-1">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_02.png">
            </div>
            <div class="items lottery-unit-2">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_03.png">
            </div>
        </div>
        <div class="lottery-mid flex">
            <div class="items lottery-unit-3">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_04.png">
            </div>
            <div class="items lottery-unit-4">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_05.png">
            </div>
            <div class="items lottery-unit-5">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_06.png">
            </div>
        </div>
        <div class="lottery-foot flex">
            <div class="items lottery-unit-6">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_09.png">
            </div>
            <div class="items lottery-unit-7">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/lottery_blank_08.png">
            </div>
            <div class="items lottery-unit-8">
                <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/1_21.png">
            </div>
        </div>
    </div>
</div>
<div class="footer">
    <p>*抽一次消耗<span class="num">500</span>积分</p>
    <div class="lottery-btn">
        <div class="left-btn">抽1次</div>
        <div class="right-btn">抽5次</div>
    </div>
</div>
<div class="box" style="margin-top:0.9rem;">
    <img src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/jifenzhuandayun/addres_10.png" width="100%">
</div>
<script src="http://cdn.renrenaijia.com/CDN/lib/zepto/zepto.touch.min.js"></script>
<script src="http://cdn.renrenaijia.com/CDN/app/Public/images/kmjrAppV3/page/8yuexiaomiqudao/swiper.min.js"></script>

<script>
    var swiper = new Swiper('.swiper-container', {
        pagination: '.swiper-pagination',
        paginationClickable: true,
        direction: 'vertical',
        autoplay: 1500,//可选选项，自动滑动
        loop : true,
        slidesPerView:1,
        slidesPerColumn:1,
        spaceBetween:15
    });
    var num =0;
    $('.shanDeng').attr('class',function () {
        setInterval(function () {
            num++;
            if(num%2===0){
                $('#deng').addClass('shanDeng2');
            }else{
                $('#deng').removeClass('shanDeng2');
                $('#deng').addClass('shanDeng');
            }
        },500)
    });





    $(function () {
        lottery.init('lottery');
        $(".left-btn").click(function(){
            if (click) {
                return false;
            }else{
                index=4;
                lottery.speed=100;
                roll();
                click=true;
                return false;
            }
        });
        indexArray=[];
        for (var t=0;t<5;t++){
            index=parseInt(Math.random()*10-1);
            indexArray.push(index);
        }
        $('.right-btn').click(function () {
            if (click) {
                return false;
            }else{
                //console.log(indexArray);
                lottery.speed=100;
                roll();
                click=true;
                return false;
            }
        })
    })//end
    var lottery={
        index:-1,     //当前转动到哪个位置，起点位置
        count:0,     //总共有多少个位置
        timer:0,     //setTimeout的ID，用clearTimeout清除
        speed:1000,   //初始转动速度
        times:0,     //转动次数
        cycle:30,    //转动基本次数：即至少需要转动多少次再进入抽奖环节
        prize:-1,    //中奖位置
        init:function(id){
            if ($("#"+id).find(".items").length>0) {
                $lottery = $("#"+id);                   //抽奖最外层id
                $units = $lottery.find(".items");       //找到抽奖单元
                this.obj = $lottery;
                this.count = $units.length;             //总共有多少个奖品
                $lottery.find(".lottery-unit-"+this.index).addClass("cj-active"); // 初始化是没有激活状态
            }
        },
        roll:function(){
            var index = this.index;
            var count = this.count;
            var lottery = this.obj;
            $(lottery).find(".lottery-unit-"+index).removeClass("cj-active");   //让index未增加1时的奖品去掉激活状态
            index += 1;                 //index 开始递增
            if (index>count-1) {        //当index超过奖品数量-1时 让index从零开始
                index = 0;
            }
            $(lottery).find(".lottery-unit-"+index).addClass("cj-active"); // 开始递增后下一个为激活
            this.index=index;           //保存记录下现在的index
            return false;               //结束滚动
        },
        fiveRoll:function () {
            var index = this.index;
            var count = this.count;
            var lottery = this.obj;
            $(lottery).find(".lottery-unit-"+index).removeClass("cj-active");   //让index未增加1时的奖品去掉激活状态
            index += 1;                 //index 开始递增
            if (index>count-1) {        //当index超过奖品数量-1时 让index从零开始
                index = 0;
            }
            $(lottery).find(".lottery-unit-"+index).addClass("cj-active"); // 开始递增后下一个为激活
            this.index=index;           //保存记录下现在的index
            return false;
        }
    };

    function roll(){

        console.log(indexArray);
        var len=indexArray.length;
        lottery.times += 1;
        lottery.fiveRoll();//转动过程调用的是lottery的roll方法，这里是第一次调用初始化

        lottery.prize = indexArray[2];
        console.log(lottery.times+'ssssssssss');
       if (lottery.times > lottery.cycle+10 && lottery.prize==lottery.index) {
            console.log('pppppppppppppppppppppppppppppppp');
           $(lottery).find(".lottery-unit-"+indexArray[2]).addClass("another-active"); // 开始递增后下一个为激活
           clearTimeout(lottery.timer);        //让指定奖品显示出来，结束旋转

           lottery.prize=-1;                   //初始化抽奖信息位置
           lottery.times=0;                    //初始化抽奖信息
           click=false;

       }else{
          if (lottery.times<lottery.cycle) {
               lottery.speed -= 10;
           }else{
               if (lottery.times > lottery.cycle+10 && ((lottery.prize==0 && lottery.index==11) || lottery.prize==lottery.index+1)) {
                   lottery.speed += 110;
               }else{
                   lottery.speed += 20;
               }
           }
           if (lottery.speed<40) {
               lottery.speed=40;
           };
           lottery.timer = setTimeout(roll,lottery.speed);//循环调用
       }

return false

                      //奖品位置
       /* console.log(lottery.prize);
       // lottery.prize = index;
        lottery.times += 1;
        lottery.roll();//转动过程调用的是lottery的roll方法，这里是第一次调用初始化                   //转动过程调用的是lottery的roll方法，这里是第一次调用初始化
        if (lottery.times > lottery.cycle+10 && lottery.prize==lottery.index) {
            var oPrize=lottery.prize;
            clearTimeout(lottery.timer);        //让指定奖品显示出来，结束旋转
            lottery.prize=-1;                   //初始化抽奖信息位置
            lottery.times=0;                    //初始化抽奖信息
            click=false;                        //初始化抽奖信息
//            var data={0:'“爱字”', 1:'77元红包',2:'52元现金',3:'“在”字',4:'520元红包',5:'100元京东卡',6:'“夕”字',7:'Bering情侣表',8:'13140积分',9:'“七”字',10:'CK男士钱包',11:'香奈儿香水'};
//            var $content=$('.zmx_dialog_bg0').find('.zmx_dialog_color');
//            var $state=$('.zmx_dialog_bg0').find('.zmx_dialog_state');
//            if(oPrize==1){
//                var time1= setTimeout(function () {
//                    $content.html(data[0]);
//                    $state.html('(集齐“爱在七夕”平分体验金)');
//                    $('.zmx_dialog_bg0').show();
//                },500);
//            };
//            $('.zmx_dialog_btn_common').on('click',function () {
//                $('.zmx_dialog_bg0').hide();
//            });
        }else{
            if (lottery.times<lottery.cycle) {
                lottery.speed -= 10;
            }else{
                if (lottery.times > lottery.cycle+10 && ((lottery.prize==0 && lottery.index==11) || lottery.prize==lottery.index+1)) {
                    lottery.speed += 110;
                }else{
                    lottery.speed += 20;
                }
            }
            if (lottery.speed<40) {
                lottery.speed=40;
            };
            lottery.timer = setTimeout(roll,lottery.speed);//循环调用
        }
        return false;*/
    }
    function fiveRoll() {
        console.log(index);
        lottery.prize = index;                   //奖品位置
        lottery.times += 1;
        lottery.roll();                         //转动过程调用的是lottery的roll方法，这里是第一次调用初始化
        if (lottery.times > lottery.cycle+10 && lottery.prize==lottery.index) {
            var oPrize=lottery.prize;
            clearTimeout(lottery.timer);        //让指定奖品显示出来，结束旋转
            lottery.prize=-1;                   //初始化抽奖信息位置
            lottery.times=0;                    //初始化抽奖信息
            click=false;                        //初始化抽奖信息
//            var data={0:'“爱字”', 1:'77元红包',2:'52元现金',3:'“在”字',4:'520元红包',5:'100元京东卡',6:'“夕”字',7:'Bering情侣表',8:'13140积分',9:'“七”字',10:'CK男士钱包',11:'香奈儿香水'};
//            var $content=$('.zmx_dialog_bg0').find('.zmx_dialog_color');
//            var $state=$('.zmx_dialog_bg0').find('.zmx_dialog_state');
//            if(oPrize==1){
//                var time1= setTimeout(function () {
//                    $content.html(data[0]);
//                    $state.html('(集齐“爱在七夕”平分体验金)');
//                    $('.zmx_dialog_bg0').show();
//                },500);
//            };
//            $('.zmx_dialog_btn_common').on('click',function () {
//                $('.zmx_dialog_bg0').hide();
//            });
        }else{
            if (lottery.times<lottery.cycle) {
                lottery.speed -= 10;
            }else{
                if (lottery.times > lottery.cycle+10 && ((lottery.prize==0 && lottery.index==11) || lottery.prize==lottery.index+1)) {
                    lottery.speed += 110;
                }else{
                    lottery.speed += 20;
                }
            }
            if (lottery.speed<40) {
                lottery.speed=40;
            };
            lottery.timer = setTimeout(fiveRoll,lottery.speed);//循环调用
        }
        return false;
    }






    var click=false;








</script>
</body>
</html>